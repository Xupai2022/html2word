# HTML转Word图片测试套件

## 测试文件说明

本测试套件包含两个全面的HTML测试文件，用于验证HTML转Word过程中的图片处理效果。

### 1. test_images_comprehensive.html - 全面覆盖基础场景

#### 包含的测试场景：

##### 1.1 基础图片
- 普通 `<img>` 标签
- 带标题的图片容器
- 简单的图文组合

##### 1.2 响应式图片
- `max-width: 100%` 响应式布局
- 自适应容器宽度

##### 1.3 带样式的图片
- 边框、圆角、阴影效果
- 圆形图片（头像样式）
- 固定尺寸 + `object-fit: cover`
- 半透明效果（opacity）

##### 1.4 图文混排 - 浮动
- 左浮动图片 + 文字环绕
- 右浮动图片 + 文字环绕
- 多段落环绕测试

##### 1.5 图片链接
- 单张图片作为链接
- 多图片链接网格
- Hover效果测试

##### 1.6 CSS Grid 图片网格
- 响应式网格布局
- 自动填充列
- `object-fit` 等比例裁剪

##### 1.7 图片在表格中
- 产品列表表格
- 图文混排单元格
- 图片尺寸限制

##### 1.8 背景图片
- CSS `background-image` 容器
- 渐变叠加效果
- 多层背景测试

##### 1.9 SVG图片
- 内联SVG图形
- Base64编码的SVG

##### 1.10 图片堆叠
- 垂直堆叠布局
- 图片组展示

##### 1.11 图文混合内容
- 报告式图文混排
- 多图表布局
- 侧边栏图文

##### 1.12 复杂嵌套布局
- Flexbox嵌套图片
- 卡片式设计
- 多列博客布局

##### 1.13 长文本与多个图片
- 完整的安全报告样式
- 多个图表交叉引用
- 带编号的图片说明

### 2. test_images_advanced.html - 高级与边缘场景

#### 包含的测试场景：

##### 2.1 Data URI图片
- Base64编码PNG
- JPEG Base64
- SVG Base64编码
- 内联图片无需外部请求

##### 2.2 像素与矢量混合
- PNG/JPEG与SVG混排
- 图标+文字段落
- 混合媒体内容

##### 2.3 响应式图片进阶
- `srcset` 多倍图
- `sizes` 适配规则
- 视口宽度适配

##### 2.4 CSS滤镜与变换
- `filter` 效果（灰度、模糊、亮度等）
- `transform` 变换（旋转、缩放、倾斜）
- 多效果组合

##### 2.5 懒加载与占位符
- `loading="lazy"` 属性
- 加载前占位样式
- 背景色占位

##### 2.6 复杂报告场景
- 标题 + 大图
- 图表并排网格
- 多级嵌套容器

##### 2.7 不同类型URL
- 绝对URL (https://)
- 协议相对URL
- Data URI

##### 2.8 宽高比测试
- 16:9 横屏图片
- 9:16 竖屏图片
- 1:1 正方形
- 21:9 超宽屏

##### 2.9 中文文档场景
- 政府公文样式（居中对齐）
- 企业报告样式
- 带Logo的标题栏
- 中文排版习惯

##### 2.10 大量图片性能
- 50+ 图片批量测试
- 网格画廊
- 滚动性能测试

##### 2.11 复杂嵌套布局
- 多层div嵌套
- 表格套表格
- 嵌套容器中的图片

## 使用方法

### 方法一：直接转换测试

```bash
# 测试基础场景
python -m html2word test_images_comprehensive.html comprehensive.docx

# 测试高级场景
python -m html2word test_images_advanced.html advanced.docx

# 测试所有场景
python -m html2word test_images_comprehensive.html comprehensive.docx
python -m html2word test_images_advanced.html advanced.docx
```

### 方法二：使用批量测试脚本

运行测试套件中的所有测试：

```bash
python test_all_images.py
```

这将：
- 转换所有测试HTML文件
- 生成对应的Word文档
- 输出测试结果摘要
- 生成测试报告

### 方法三：从Python代码调用

```python
from html2word import convert_to_docx

# 转换基础测试
convert_to_docx('test_images_comprehensive.html', 'comprehensive.docx')

# 转换高级测试
convert_to_docx('test_images_advanced.html', 'advanced.docx')
```

## 关注的问题

在测试转换结果时，请特别关注以下方面：

### 1. 图片显示
- ✅ 所有图片是否正确显示
- ✅ 图片尺寸是否正确
- ✅ 图片比例是否保持
- ✅ 高分屏图片是否清晰

### 2. 布局与定位
- ✅ 浮动图片位置是否正确
- ✅ 文字环绕是否正常
- ✅ 网格布局是否保持
- ✅ Flexbox布局效果

### 3. 样式处理
- ✅ 边框、阴影、圆角
- ✅ 滤镜效果（如支持）
- ✅ 透明度和混合模式
- ✅ 背景图片

### 4. 特殊场景
- ✅ Data URI图片
- ✅ SVG图片
- ✅ 表格中的图片
- ✅ 多层级嵌套

### 5. 中文文档场景
- ✅ 中文报告图文混排
- ✅ 标题图片居中
- ✅ 图注样式
- ✅ 政府/企业文档格式

### 6. 性能
- ✅ 大量图片加载性能
- ✅ Word文档大小
- ✅ 生成速度

## 预期vs实际对照检查表

| 测试项目 | 预期结果 | 实际结果 | 备注 |
|---------|---------|---------|------|
| 基础图片显示 | ✅ | ⬜ | |
| 响应式尺寸调整 | ✅ | ⬜ | |
| 边框/圆角/阴影 | ✅ | ⬜ | |
| 左浮动布局 | ✅ | ⬜ | |
| 右浮动布局 | ✅ | ⬜ | |
| 图片链接 | ✅ | ⬜ | |
| CSS Grid布局 | ✅ | ⬜ | |
| 表格中的图片 | ✅ | ⬜ | |
| 背景图片 | ✅ | ⬜ | |
| SVG图片 | ✅ | ⬜ | |
| Data URI图片 | ✅ | ⬜ | |
| 中文报告样式 | ✅ | ⬜ | |
| 长文档多图片 | ✅ | ⬜ | |

## 常见问题排查

### 问题1: 图片不显示

可能原因：
- URL无法访问（需要联网）
- Data URI格式不支持
- 安全策略限制

解决方案：
- 确保网络连接正常
- 检查图片URL是否有效
- 尝试使用本地图片

### 问题2: 样式丢失

可能原因：
- CSS属性不支持
- 样式被覆盖
- 选择器不匹配

解决方案：
- 检查支持的CSS属性列表
- 使用内联style属性
- 简化样式规则

### 问题3: 布局错乱

可能原因：
- 浮动布局不支持
- Flexbox/Grid不支持
- 定位属性不兼容

解决方案：
- 使用表格布局替代
- 简化嵌套层级
- 使用绝对尺寸

### 问题4: Word文档过大

可能原因：
- 图片未压缩
- 分辨率过高
- 嵌入过多资源

解决方案：
- 添加图片压缩
- 限制最大分辨率
- 减少不必要图片

## 扩展测试建议

根据初步测试结果，可进一步创建：

1. **真实场景测试**
   - 使用真实的网络威胁报告
   - 包含实际的图表和截图
   - 包含中文字符的图片

2. **边界测试**
   - 超大尺寸图片（5000px+）
   - 极小图片（16x16 favicon）
   - 极限长宽比

3. **交互元素**
   - 带JavaScript的图表
   - Canvas生成的图片
   - WebGL内容

4. **打印优化**
   - 打印样式表
   - 分页控制
   - 页眉页脚图片

## 更新日志

- 2025-01-21: 创建完整测试套件
  - 基础场景测试文件
  - 高级场景测试文件
  - 使用说明文档
  - 批量测试脚本

## 联系与反馈

如需添加更多测试场景或报告问题，请：

1. 新增测试用例到合适的测试文件
2. 或使用提供的测试文件作为模板创建新场景
3. 记录所有发现的问题和异常行为

---

**注意**：本测试套件使用 picsum.photos 提供的测试图片，确保网络连接正常以正确加载所有图片资源。
